
<script language="javascript" type="text/javascript"><!--

$j(document).ready(function() {
  
  var title = 'start-coding';
  
  $cd.startCoding = function(id, avatar_name, start_grid) {
    var grid = $j('<div>');
    var starter = $j('<div>')
      .html(start_grid)
      .dialog({
        autoOpen: false,
        title: $cd.h1(title),
        width: 400,
        modal: true,
        buttons: {
          ok: function() {
            $cd.postTo('/kata/edit', { id: id, avatar: avatar_name  }, '_blank');              
            $j(this).dialog('close');
          }
        }
      });
      starter.dialog('open');
  };
  
  $cd.dialog_fullDojo = function(id) {
    var grid = $j('<div>');
    grid.load('/dojo/full_avatar_grid', { id: id }, function() {
      var resumer = $j('<div>')
        .html(grid.html())
        .dialog({
          autoOpen: false,
          title: $cd.h1('!' + title),
          width: 600,
          modal: true,
          buttons: {
            ok: function() {
              $j(this).dialog('close');
            }
          }
        });
      resumer.dialog('open');
    });
  };
    
  $j('#start_coding').click(function() {
    $cd.run('start_json', function(id, dojo) {
      if (dojo.exists === false) {
        $cd.dialog_cantFindDojo(title, id);
      } else if (dojo.full === true) {
        $cd.dialog_fullDojo(id);
      } else {
        $cd.startCoding(id, dojo.avatar_name, dojo.start_grid);
      }
    });
  });

});

//--></script>

<input type="button"
       class="large button"
       id="start_coding"
       value="start" />
