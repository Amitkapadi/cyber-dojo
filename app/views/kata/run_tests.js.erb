
var appendTestTrafficLight = function() {
  var testRag = "<%= @last_rag %>";
  var lightsCount = $('.diff-traffic-light').size();
  var img = $('<img>', {
    'src': '/images/bulb_' + testRag + '.png',
    'alt': testRag + ' traffic-light'
  });
  var div = $('<div>', {
    'class': 'diff-traffic-light',
    'data-tip':'ajax:traffic_light',
    'data-id': "<%= @kata.id %>",
    'data-avatar-name': "<%= @avatar.name %>",
    'data-colour': testRag,
    'data-was-tag': lightsCount,
    'data-now-tag': lightsCount + 1
  });
  var td = $('<td>');
  div.append(img);
  td.append(div);
  $('.traffic-lights-count').parent().before(td);
};

//- - - - - - - - - - - - - - - - - - - - - -

$('#output')
  .html("<%= js_partial('output') %>");

appendTestTrafficLight();

$('.traffic-lights-count')
  .html("<%= js_partial('traffic_lights_count') %>");

$('#traffic-lights-pie-chart')
  .html("<%= js_partial('traffic_lights_pie_chart') %>");

cd.scrollAvatarImageIntoView();

//cd.setupHoverTips();


