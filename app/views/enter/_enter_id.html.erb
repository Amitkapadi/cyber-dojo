
<script type="text/javascript"><!--

$(function() {

  var kataIdInput = $('#kata-id-input');

  var join   = $('#join-button');
  var reJoin = $('#re-join-button');
  var review  = $('#review-button');

  var enable = function(button) {
    button.removeAttr('disabled');
  };
  var disable = function(button) {
    button.prop('disabled', true);
  };

  var setEnabled = function(button, condition) {
    if (condition) {
      enable(button);
    } else {
      disable(button);
    }
  };

  cd.enableDisableJoinReJoinReview = function() {
    var id = kataIdInput.val();
    disable(join);
    disable(reJoin);
    disable(review);
    if (id.length >= 6) {
      $.getJSON('/enter/check', { id: id }, function(dojo) {
        setEnabled(join,   dojo.exists);
        setEnabled(reJoin, dojo.exists);
        setEnabled(review,  dojo.exists);
      });
    }
  };

  kataIdInput.keyup(function() {
    cd.enableDisableJoinReJoinReview();
  });

  cd.enableDisableJoinReJoinReview();
});

//--></script>

<input title="an id contains only the digits 0123456789 and letters ABCDEF, and is case insensitive"
       type="text"
       id="kata-id-input"
       size="8"
       value="<%= @id[0..5] %>">
</input>
